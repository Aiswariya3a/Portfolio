{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{{ settings.site_title }}</title>
    <meta
      name="description"
      content="{% block meta_description %}{{ settings.site_description }}{% endblock meta_description %}"
    />
    <meta name="keywords" content="{{ settings.site_keywords }}" />
    <meta name="author" content="Aiswariya S" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="{{ request.build_absolute_uri }}" />
    <meta
      property="og:title"
      content="{% block og_title %}{{ settings.site_title }}{% endblock og_title %}"
    />
    <meta
      property="og:description"
      content="{% block og_description %}{{ settings.site_description }}{% endblock og_description %}"
    />
    {% if settings.social_preview_image %}
    <meta
      property="og:image"
      content="{% block og_image %}{{ request.scheme }}://{{ request.get_host }}{{ settings.social_preview_image.url }}{% endblock og_image %}"
    />
    {% endif %}
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Audiowide&family=Poppins:wght@400;600;700&display=swap"
      rel="stylesheet"
    />

    <link href="{% static 'css/output.css' %}" rel="stylesheet" />
    <link href="{% static 'css/output.css' %}" rel="stylesheet" />
    {{ projects_json|json_script:"projects-data" }} {{
    skills_json|json_script:"skills-data" }}
  </head>
  <body class="bg-gray-900 text-white">
    <main>{% block content %} {% endblock content %}</main>

    <div
      id="konami-overlay"
      class="hidden fixed inset-0 bg-black z-50 flex items-center justify-center cursor-pointer"
    >
      <div
        id="game-info"
        class="absolute top-5 left-5 font-display text-2xl text-white"
      >
        Score: 0
      </div>
      <canvas id="matrix-canvas"></canvas>
    </div>

    <div id="ai-chat-widget">
      <button
        id="chat-toggle"
        class="fixed bottom-8 right-8 bg-gradient-to-r from-neon-teal to-neon-purple p-4 rounded-full shadow-lg text-white z-40"
        aria-label="Open AI chat assistant"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="h-8 w-8"
          viewBox="0 0 20 20"
          fill="currentColor"
        >
          <path
            fill-rule="evenodd"
            d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z"
            clip-rule="evenodd"
          />
        </svg>
      </button>

      <div
        id="chat-window"
        class="fixed bottom-24 right-8 w-96 h-[32rem] bg-charcoal rounded-xl shadow-2xl z-40 p-4 flex flex-col hidden"
      >
        <div class="flex justify-between items-center mb-4">
          <h3 class="font-display text-xl text-white">
            Chat with my AI Assistant
          </h3>
          <button id="chat-close" class="text-gray-400 hover:text-white" aria-label="Close chat window">
            &times;
          </button>
        </div>
        <div
          id="chat-messages"
          class="flex-grow bg-midnight p-3 rounded-lg overflow-y-auto mb-4"
        >
          <div class="p-2 text-gray-300">
            Hello! Ask me about my skills or projects.
          </div>
        </div>
        <div class="flex">
          <input
            type="text"
            id="chat-input"
            placeholder="Type your message..."
            class="flex-grow bg-midnight text-white p-2 rounded-l-md focus:outline-none focus:ring-2 focus:ring-neon-teal"
          />
          <button
            id="chat-send"
            class="bg-neon-teal text-midnight font-bold px-4 rounded-r-md"
          >
            Send
          </button>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/tsparticles@2/tsparticles.bundle.min.js"></script>

    <script src="{% static 'js/particles-config.js' %}"></script>
    <script src="{% static 'js/main.js' %}"></script>
  </body>
</html>
